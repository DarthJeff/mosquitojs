/*! mosquitojs - v0.2.4 - 2016-04-10
* Copyright (c) 2016 Jeff Brannon; Licensed MIT */
"use strict";var mosquito=function(){};mosquito.prototype={internal:{modules:[],mosquitoModule:function(a){this.internal.moduleSelf=this,this.internal.dependentModules=a}},module:function(a,b){if(b){if(void 0!==this.internal.modules[a])throw"Module already defined: "+a;return this.internal.modules[a]=new this.internal.mosquitoModule(b)}if(void 0===this.internal.modules[a])throw"Module undefined: "+a;return this.internal.modules[a]}};var mosquito=window.mosquito,mosquitoModule=mosquito.prototype.internal.mosquitoModule;mosquitoModule.prototype={internal:{moduleServices:[],moduleControllers:[],extend:function(){},preConstructServiceMethod:function(){},constructNewServiceMethodInstance:function(a){return new this.constructServiceMethod(a,this)},constructServiceMethod:function(a,b){function c(a){function b(a){function b(){if(void 0===d.moduleDependents){d.moduleDependents=[d.moduleSelf];for(var a=0;a<d.dependentModules.length;a++)d.moduleDependents.push(mosquito.internal.modules[d.dependentModules[a]])}}b();for(var c=0;c<d.moduleDependents.length;c++){var e=d.moduleDependents[c].service(a);return void 0!==e&&void 0===e.instance&&(e.isNewableServiceType?e.instance=d.constructNewServiceMethodInstance(e):e.instance=d.constructServiceMethod(e)),e.instance}throw"Service undefined: "+a}for(var c=[],e=0;e<a.length;e++)c.push(b(a[e]));return c}var d=b||this;d.preConstructServiceMethod(a);var e=c(a.dependentServices);return a.constructor.apply(this,e)},asArray:function(a){return a instanceof Array==!1&&(a=[a]),a}}};var mosquito=window.mosquito,mosquitoModule=mosquito.prototype.internal.mosquitoModule;mosquitoModule.prototype.internal.mosquitoService=function(a,b,c,d,e){if(d){if(void 0!==this.moduleServices[b]&&!e)throw"Service already defined: "+b;var f={isNewableServiceType:a,dependentServices:c,constructor:d};return this.extend(f),this.moduleServices[b]=f}return this.moduleServices[b]},mosquitoModule.prototype.internal.getParametersFromConstructor=function(a){var b={dependentServices:[],constructor:a};return a instanceof Array&&(b.constructor=a.pop(),b.dependentServices=a),b},mosquitoModule.prototype.internal.addService=function(a,b,c,d){var e=this.getParametersFromConstructor(b);return this.mosquitoService(c||!1,a,e.dependentServices,e.constructor,d||!1)},mosquitoModule.prototype.service=function(a,b){return this.internal.addService(a,b,!0)},mosquitoModule.prototype.factory=function(a,b){return this.internal.addService(a,b)},mosquitoModule.prototype.provider=function(a,b){var c=this.internal.mosquitoService(!1,a,[],b),d=this.internal.constructNewServiceMethodInstance(c);return this.internal.addService(a,d.$get,!1,!0)},mosquitoModule.prototype.run=function(a){if(void 0===a)throw"Run method undefined";var b=this.internal.getParametersFromConstructor(a),c=mosquito.runMethods;if(c||(mosquito.runMethods=c=[]),c.push(b),1===c.length){var d=this.internal;document.onreadystatechange=function(){if("complete"===document.readyState)for(var a=0;a<c.length;a++)d.constructServiceMethod(c[a],d)}}},mosquitoModule.prototype.controller=function(a,b){if(b){if(void 0!==this.internal.moduleControllers[a])throw"Controller already defined: "+a;return this.internal.moduleControllers[a]=this.internal.getParametersFromConstructor(b),this.internal.extend(this.internal.moduleControllers[a]),this.internal.moduleControllers[a]}if(void 0===this.internal.moduleControllers[a])throw"Controller undefined: "+a;return void 0===this.internal.moduleControllers[a].instance&&(this.internal.moduleControllers[a].instance=this.internal.constructNewServiceMethodInstance(this.internal.moduleControllers[a])),this.internal.moduleControllers[a].instance};var mosquito=window.mosquito,mosquitoModule=mosquito.prototype.internal.mosquitoModule;mosquitoModule.prototype.internal.extend=function(a){var b=this;a.fromObservableInterface=function(c){c=b.asArray(c),a.observableInterfaces=c}},mosquitoModule.prototype.internal.preConstructServiceMethod=function(a){if(void 0!==a.observableInterfaces)for(var b=0;b<a.observableInterfaces.length;b++){var c=a.observableInterfaces[b];void 0===mosquito.internal.observableInterfaceMethods[c]&&(mosquito.internal.observableInterfaceMethods[c]=[]),mosquito.internal.observableInterfaceMethods[c].push(a)}},mosquitoModule.prototype.observableInterface=function(a,b){function c(a,b){return b=d.asArray(b),mosquito.internal.observableInterfaceMethods||(mosquito.internal.observableInterfaceMethods=[]),function(){this.next=function(c,d){if(-1===b.indexOf(c))throw"Observable method not declared: "+c;var e=mosquito.internal.observableInterfaceMethods,f=e[a];if(void 0!==f)for(var g=0;g<f.length;g++)void 0!==f[g].instance&&void 0!==f[g].instance[c]&&f[g].instance[c](d)}}}var d=this.internal;return this.internal.mosquitoService(!0,a,[],c(a,b))},window.mosquito=new window.mosquito;
